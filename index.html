<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tauri SVG Processor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            width: 100%;
            max-width: 1200px;
            min-height: 80vh;
        }
        
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .svg-container {
            width: 100%;
            height: 70vh;
            position: relative;
        }
        
        .svg-object {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #666;
        }
        
        .status {
            padding: 10px 20px;
            background: #f8f9fa;
            border-top: 1px solid #dee2e6;
            font-size: 14px;
            color: #666;
        }
        
        .config-info {
            background: #e3f2fd;
            padding: 10px 20px;
            border-left: 4px solid #2196f3;
            margin: 10px 20px;
            border-radius: 4px;
            font-size: 12px;
            color: #1976d2;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Tauri SVG Processor</h1>
            <p>Dynamic SVG processing with PHP backend</p>
        </div>
        
        <div class="config-info" id="config-info">
            Loading configuration...
        </div>
        
        <div class="svg-container">
            <div class="loading" id="loading">
                <h3>‚è≥ Loading SVG Application...</h3>
                <p>Connecting to PHP server...</p>
            </div>
            <object class="svg-object" id="svg-processor" data="" type="image/svg+xml">
                Your browser does not support SVG objects.
            </object>
        </div>
        
        <div class="status" id="status">
            Ready to load SVG processor
        </div>
    </div>

    <script>
        // ULTRA-SIMPLE CONFIG SYSTEM
        // Direct .env variable access without complex generators
        const CONFIG = {
            // Parse .env variables from backend or use defaults
            phpPort: '8088',
            svgFile: 'todo.php.svg',
            
            // Get config from URL params (for testing)
            getFromUrl: function() {
                const params = new URLSearchParams(window.location.search);
                return {
                    phpPort: params.get('port') || this.phpPort,
                    svgFile: params.get('file') || this.svgFile
                };
            }
        };

        // Initialize app with ultra-simple config
        function initApp() {
            const config = CONFIG.getFromUrl();
            const svgUrl = `http://localhost:${config.phpPort}/${config.svgFile}`;
            
            // Update UI
            document.getElementById('config-info').innerHTML = `
                üì° Server: localhost:${config.phpPort} | üìÑ File: ${config.svgFile}
            `;
            
            document.getElementById('status').textContent = `Connecting to ${svgUrl}`;
            
            // Load SVG
            const svgObject = document.getElementById('svg-processor');
            svgObject.data = svgUrl;
            
            // Test connection
            fetch(svgUrl)
                .then(response => {
                    if (response.ok) {
                        document.getElementById('loading').style.display = 'none';
                        document.getElementById('status').innerHTML = `‚úÖ Connected to PHP server`;
                        // Refresh every 10 seconds
                        setTimeout(() => {
                            svgObject.data = svgUrl + '?t=' + Date.now();
                        }, 10000);
                    } else {
                        throw new Error('Server not ready');
                    }
                })
                .catch(error => {
                    document.getElementById('status').innerHTML = `‚ùå PHP server not running - Start with: ./start.sh`;
                    // Retry every 5 seconds
                    setTimeout(initApp, 5000);
                });
        }

        // Start app
        initApp();
    </script>
</body>
</html>
